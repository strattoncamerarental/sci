# Custom 404 Error Page
ErrorDocument 404 /404.html

# ------------------------------
# Expiration & Cache-Control
# ------------------------------
<IfModule mod_expires.c>
  ExpiresActive On

  # HTML: never cache (propagate markup changes immediately)
  ExpiresByType text/html "access plus 0 seconds"

  # CSS/JS: shorter cache since filenames don't change (SW also revalidates)
  ExpiresByType text/css "access plus 1 day"
  ExpiresByType application/javascript "access plus 1 day"

  # Images: generous but not forever
  ExpiresByType image/webp "access plus 6 months"
  ExpiresByType image/jpeg "access plus 6 months"
  ExpiresByType image/png  "access plus 6 months"
  ExpiresByType image/gif  "access plus 6 months"
  ExpiresByType image/svg+xml "access plus 6 months"
  ExpiresByType image/x-icon "access plus 1 year"

  # Fonts
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType font/woff  "access plus 1 year"

  # JSON / manifest / sitemap
  ExpiresByType application/json "access plus 1 day"
  ExpiresByType application/manifest+json "access plus 1 day"
  ExpiresByType text/xml "access plus 1 hour"
  ExpiresByType application/xml "access plus 1 hour"
</IfModule>

<IfModule mod_headers.c>
  # HTML: force no-cache
  <FilesMatch "\.(html?|shtml|php)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate, max-age=0"
  </FilesMatch>

  # CSS/JS: shorter cache, no immutable (since no ?v=)
  <FilesMatch "\.(css|js)$">
    Header set Cache-Control "public, max-age=86400"
  </FilesMatch>

  # Images & fonts: cache long
  <FilesMatch "\.(png|jpe?g|gif|webp|svg|ico|woff2?|ttf|otf)$">
    Header set Cache-Control "public, max-age=15552000"
  </FilesMatch>

  # JSON/manifest: moderate cache
  <FilesMatch "\.(json|webmanifest)$">
    Header set Cache-Control "public, max-age=86400"
  </FilesMatch>

  # SW must never be cached (critical!)
  <FilesMatch "^sw\.js$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
  </FilesMatch>
</IfModule>